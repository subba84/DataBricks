@model DataBricksWeb.Database.User
@{
    ViewBag.Title = "Index";
}





<section class="content-header">
    <h1>
        User

    </h1>
    <ol class="breadcrumb">
        <li><a href="/dashboard/landingpage"><i class="fa fa-dashboard"></i> Home</a></li>
        <li><a href="/user/list">Users List</a></li>
        <li class="active">Add User</li>
    </ol>
</section>
<div id="newloader">
    <section class="content">
        <br />
        <br />
        <br />
        <br />
        <br />
        <div class="row">
            <div class="col-md-4">
            </div>
            <div class="col-md-4">
                <img style="width: 30%;margin-left: 100px;margin-top: 55px;" src="~/NewAdmin/dist/img/loading-waiting.gif" class="img-circle" alt="User Image">
            </div>
            <div class="col-md-4">
            </div>
        </div>
    </section>
</div>
<!-- Main content -->
<div id="tablehide" style="display:none;">
    <section class="content">

        <!-- SELECT2 EXAMPLE -->
        <div class="box box-default">

            <!-- /.box-header -->
            <form method="post" action="@Url.Action("Edit","ManageUser",new { area = "Partner"})" enctype="multipart/form-data" id="frmUser">
                <div class="box-body">
                    <div class="row">

                        <div class="col-md-6">
                            <div class="form-group">
                                <label>Your Company <span style="color:red;">*</span></label>
                                <input type="text" class="form-control" readonly value="@Model.CompanyName" id="txtCompany" name="CompanyName" maxlength="256" placeholder="Your Company" />
                                <input type="hidden" name="Id" value="@Model.Id" />
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label>Name<span style="color:red;">*</span></label>
                                <input type="text" class="form-control" value="@Model.FullName" id="txtFullname" name="FullName" maxlength="256" placeholder="Name" />
                            </div>
                        </div>

                        <div class="col-md-6">
                            <div class="form-group">
                                <label>Phone<span style="color:red;">*</span></label>
                                <input type="text" class="form-control" id="txtPhone" value="@Model.PhoneNumber" name="PhoneNumber" maxlength="64" placeholder="Phone" />
                            </div>
                        </div>

                        <div class="col-md-6">
                            <div class="form-group">
                                <label>Role<span style="color:red;">*</span></label>
                                <select class="form-control" id="slRole" name="RoleId">
                                    <option value="0">--Select--</option>
                                    @if (Model.RoleId == UserRoleIds.Sales)
                                    {
                                        <option value="@UserRoleIds.Sales" selected>Sales</option>
                                        <option value="@UserRoleIds.Technical">Technical</option>
                                    }
                                    else if (Model.RoleId == UserRoleIds.Technical)
                                    {
                                        <option value="@UserRoleIds.Sales">Sales</option>
                                        <option value="@UserRoleIds.Technical" selected>Technical</option>
                                    }
                                    else
                                    {
                                        <option value="@UserRoleIds.Sales">Sales</option>
                                        <option value="@UserRoleIds.Technical">Technical</option>
                                    }

                                </select>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label>Country<span style="color:red;">*</span></label>
                                <input type="text" class="form-control" value="@Model.CountryName" readonly name="CountryName" id="txtCountryName" placeholder="Country" />
                                <input type="hidden" class="form-control" value="@Model.CountryId" name="CountryId" id="txtCountryId" />
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label>City<span style="color:red;">*</span></label>
                                <input type="text" class="form-control" value="@Model.CityName" readonly name="CityName" id="txtCityName" placeholder="City" />
                                <input type="hidden" class="form-control" value="@Model.CityId" name="CityId" id="txtCityId" />
                            </div>
                        </div>

                        <div class="col-md-6" style="display:none">
                            <div class="form-group">
                                <label>IsActive</label>
                                <input type="checkbox" value="true" name="IsActive" checked />
                            </div>
                        </div>

                        <div class="col-md-6">
                            <div class="form-group">
                                <label>Address<span style="color:red;">*</span></label>
                                <textarea class="form-control" id="txtAddress" readonly rows="3" maxlength="512">@Model.FullAddress</textarea>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label>Email Id<span style="color:red;">*</span></label>
                                <input type="text" class="form-control" id="txtEmailId" value="@Model.EmailId" name="EmailId" maxlength="256" placeholder="Email Id" />
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="form-group">
                                <label>Password<span style="color:red;">*</span></label>
                                <input type="password" class="form-control" id="txtPassword" value="@Model.Password" name="Password" maxlength="128" placeholder="Password" />
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="form-group">
                                <label>Confirm Password<span style="color:red;">*</span></label>
                                <input type="password" class="form-control" id="txtConfirmPassword" value="@Model.Password" maxlength="128" placeholder="Confirm Password" />
                            </div>
                        </div>
                    </div>

                </div>


                <div class="box-footer">
                    <div class="col-lg-12 p-t-20 text-center">
                        <input type="button" style="background-color:#276235;border-color: #276235;" class="btn btn-primary" id="btnSave" value="Save" />
                        <button type="button" onclick="pageloade();" style="background-color: #dc3545; border-color: #dc3545;margin-left: 10px;" class="btn btn-primary float-center">Cancel</button>
                    </div>
                </div>
            </form>
        </div>


    </section>
    </div>





    <script src="~/Scripts/jquery-3.4.1.min.js"></script>
    <script src="~/Scripts/CustomScript.js"></script>
    <script src="~/Scripts/bootstrap.js"></script>
    <script src="~/Scripts/jquery.password-validation.js"></script>
    <script>
        function pageloade() {
            window.location = "/user/list";
        }

        $("#btnSave").click(function () {
            var companyname = $("#txtCompany").val();
            var fullname = $("#txtFullname").val();
            var phone = $("#txtPhone").val();
            var role = $("#slRole").val();
            var email = $("#txtEmailId").val();
            var password = $("#txtPassword").val();
            var confirmpassword = $("#txtConfirmPassword").val();

            if (fnIsNullorEmpty(companyname)) {
                Warning("Please enter your company name");
                return false;
            }
            if (fnIsNullorEmpty(fullname)) {
                Warning("Please enter your full name");
                return false;
            }
            if (fnIsNullorEmpty(phone)) {
                Warning("Please enter phone number");
                return false;
            }
            if (role == 0) {
                Warning("Please select role");
                return false;
            }

            if (fnIsNullorEmpty(email)) {
                Warning("Please enter email");
                return false;
            }
            if (fnIsNullorEmpty(password)) {
                Warning("Please enter password");
                return false;
            }
            if (fnIsNullorEmpty(confirmpassword)) {
                Warning("Please enter confirm password");
                return false;
            }
            if (password != confirmpassword) {
                Warning("Passwords are not matching");
                return false;
            }

            var isnotvalidpwd = false;
            $("#txtPassword").passwordValidation({ "confirmField": "#txtConfirmPassword" }, function (element, valid, match, failedCases) {

                if (valid) {
                    $(element).css("border", "2px solid green");
                }
                if (valid && match) {
                    $("#txtConfirmPassword").css("border", "2px solid green");
                }
                if (!valid) {
                    $(element).css("border", "2px solid red");
                }

                if (!valid || !match) {
                    $("#txtConfirmPassword").css("border", "2px solid red");
                }
                if (failedCases != null && failedCases.length > 0) {
                    Alert(failedCases.join("\n"));
                }
                else {
                    isnotvalidpwd = true;
                }

                if (isnotvalidpwd == true) {
                    fnFormSubmit();
                }
            });
        });

        function fnFormSubmit() {
            Confirmation("Are you sure, you want to save?");
            $("#btnConfirm").unbind().click(function () {
                $("#frmUser").submit();
            });
        };
    </script>

    <script>
        window.setInterval('refresh()', 1000);
        function refresh() {
            document.getElementById("newloader").style.display = 'none';
            document.getElementById("tablehide").style.display = 'block';
        }
        var v = document.getElementById("usernew");
        v.className += "tabcolor";
    </script>
